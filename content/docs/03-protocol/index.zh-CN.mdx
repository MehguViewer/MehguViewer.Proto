---
title: 协议规范
description: 内容服务器的数据模型和联邦逻辑。
---

# 协议规范

Core 协议定义了内容的结构和交付方式。它被设计为**多态的**，在统一的模式下支持多种媒体类型。

## 数据模型

### Series（系列，多态）
`Series` 是顶层容器。它可以表示：
- **Manga（漫画）：** 带有章节和页面的漫画。
- **Anime（动画）：** 带有剧集的视频系列。
- **Novel（小说）：** 带有章节的文本系列。

`type` 字段（`manga` | `anime` | `novel`）决定客户端如何渲染内容。

```json
{
  "id": "uuid",
  "title": "示例系列",
  "type": "manga",
  "content_warnings": ["血腥"],
  "cover_image": {
    "url": "https://...",
    "alt_text": "一个英雄站在山上"
  }
}
```

### Unit（单元）
`Unit` 表示系列中的单个可消费条目。
- 对于漫画：一个章节。
- 对于动画：一个剧集。
- 对于小说：一个章节。

### 无障碍访问
所有媒体资源必须包含 `alt_text`。这在 API 级别强制执行，以确保平台可被屏幕阅读器访问。

## 联邦逻辑

### 内容发现
客户端通过直接查询 Core 服务器来发现内容。没有中央"主索引"。客户端可能被配置为与 `core-a.example.com` 和 `core-b.example.com` 通信。

### 缓存
性能至关重要。所有 Core API 响应都包含严格的 `Cache-Control` 标头。
- **公共数据（系列/单元）：** 积极缓存（例如，`s-maxage=300`）。
- **用户数据（评论/投票）：** 缓存时间较短或根本不缓存。

## 社交功能

### 评论
评论存储在内容所在的 Core 服务器上。
- **作者徽章：** 评论包括 `admin`、`translator` 或 `moderator` 等徽章，以帮助用户识别权威来源。

### 投票
投票是简单的赞成/反对/中立整数（`1`、`-1`、`0`）。
- **无状态：** Core 服务器使用用户的访问令牌验证用户的投票。

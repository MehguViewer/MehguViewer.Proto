---
title: 设置与隐私
description: 节点初始化、管理员声明和用户隐私权利。
---

# 设置与隐私

本指南涵盖了 MehguViewer 核心节点的初始设置以及协议内置的隐私机制。

## 1. "首位用户"声明

当核心节点首次部署时,它没有数据库也没有用户。系统进入特殊的**设置模式**。

### 声明流程

1.  **部署:** 管理员启动核心节点容器。
2.  **发现:** 节点检测到空数据库。
3.  **注册:** 通过 `POST /api/v1/auth/register`(代理到认证服务器)注册的**第一个用户**自动获得 `mvn:admin` 作用域。
4.  **锁定:** 一旦创建了第一个管理员,节点切换到**生产模式**。后续注册被视为标准用户(默认为 `mvn:read` 和 `mvn:social:write`)。

### 安全提示
管理员应在部署后立即注册,以防止未授权接管。

## 2. 系统配置

管理员可以在不重启容器的情况下动态管理节点的行为。

**端点:** `PATCH /api/v1/admin/configuration`

### 关键设置
*   **`registration_open`**: 切换为 `false` 使节点私有(仅限邀请)。
*   **`maintenance_mode`**: 如果为 `true`,所有非管理员请求返回 `503 服务不可用`。
*   **`motd_message`**: 向所有客户端显示的"今日消息"。

## 3. 隐私与 GDPR

MehguViewer 设计时考虑了"删除权"。

### 账户删除
当用户通过 `DELETE /api/v1/me` 请求删除时:

1.  **认证服务器:**
    *   用户记录被永久删除。
    *   所有活动会话被撤销。
    *   个人数据(电子邮件、密码哈希)被清除。

2.  **核心节点(联邦删除):**
    *   认证服务器广播 `user.deleted` 事件(或核心节点在令牌验证失败时发现)。
    *   **评论与评价:** **不会**被删除以保留对话上下文。相反,`author_urn` 被迁移到系统幽灵用户: `urn:mvn:user:deleted`。
    *   **投票:** 匿名保留。
    *   **阅读历史:** 永久删除。

### 数据导出
用户可以通过 `GET /api/v1/me/export` 请求完整的数据导出(阅读历史、列表)(实现中)。
